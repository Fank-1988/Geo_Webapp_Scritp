# Geo_Webapp_Scritp

‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° doGet ( e ) {
‡∏™‡πà‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏µ‡πàHtmlService createTemplateFromFile ( "‡∏î‡∏±‡∏ä‡∏ô‡∏µ" ) . ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô( )
‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâClick ( ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•) {
‡πÉ‡∏´‡πâ ss = SpreadsheetApp ‚ÄãopenById ( 'xxx' ) ;
‡πÉ‡∏´‡πâ ‡∏á‡∏≤‡∏ô= ss ‡∏£‡∏±‡∏ö‡∏ä‡∏µ‡∏ï ( ) [ 0 ] ;
‡πÉ‡∏´‡πâ ‡∏ï‡∏≠‡∏ö ‡∏Å‡∏•‡∏±‡∏ö= Maps ‡πÅ‡∏ó‡∏ô Geocoder ( ) . ReverseGeocode ( data.lat , data.lon ) ;
‡πÉ‡∏´‡πâ geoAddress = ‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö‡∏™‡∏ô‡∏≠‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå[ 0 ] . ‡∏à‡∏±‡∏î‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö_‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà;
‡∏á‡∏≤‡∏ôappendRow ( [ data .username , Utilities . formatDate ( new Date ( ) , "GMT+7" , "MM/dd/yyyy HH :mm:ss" ) , $ { data .lat } , $ { data . lon } , ‡∏ó‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô‡∏ô‡∏µ‡πâ] )

#
var strYear543 = parseInt ( Utilities . formatDate ( ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏î‡∏ó ( ) , "Asia/Bangkok" , "yyyy" ) ) + 543 ;
var strhour = ‡∏¢‡∏π‡∏ó‡∏¥‡∏•‡∏¥‡∏ï‡∏µ‡πâformatDate ( ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏î‡∏ó ( ) , "‡πÄ‡∏≠‡πÄ‡∏ä‡∏µ‡∏¢/‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø" , "HH" ) ;
var strMinute = ‡∏¢‡∏π‡∏ó‡∏¥‡∏•‡∏¥‡∏ï‡∏µ‡πâformatDate ( ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏î‡∏ó ( ) , "‡πÄ‡∏≠‡πÄ‡∏ä‡∏µ‡∏¢/‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø" , "mm" ) ;
var strMonth1 = ‡∏¢‡∏π‡∏ó‡∏¥‡∏•‡∏¥‡∏ï‡∏µ‡πâformatDate ( ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï ( ) , "‡πÄ‡∏≠‡πÄ‡∏ä‡∏µ‡∏¢/‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø" , "M" ) ;
var strMonthCut1 = [ "" , "‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°" , "‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå" , "‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°" , " ‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô" , "‡∏≠‡∏≤‡∏à" , "‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô‡∏≤‡∏¢‡∏ô‡∏≤‡∏¢‡∏ô" , "‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°" , "‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°" , "‡∏¢‡∏≤‡∏¢‡∏Å‡∏±‡∏ô‡∏ô" , " ‡∏Å‡∏•‡πà‡∏≤‡∏ß‡∏ñ‡∏∂‡∏á " , "‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô" , "‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°" ]
var strMonthThai = strMonthCut1 [ strMonth1 ] ;
var strDay = ‡∏¢‡∏π‡∏ó‡∏¥‡∏•‡∏¥‡∏ï‡∏µ‡πâformatDate ( ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏î‡∏ó ( ) , "‡πÄ‡∏≠‡πÄ‡∏ä‡∏µ‡∏¢/‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø" , "d" ) ; // d ‡πÑ‡∏°‡πà‡∏°‡∏µ 0 ‡∏ô‡∏≥ dd ‡∏°‡∏µ 0 ‡∏ô‡∏≥
var ‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô= strDay + ' ' + strMonthThai + ' ' + strYear543 + ' ‡πÄ‡∏ß‡∏•‡∏≤ ' + strhour + ':' + strMinute + ' ‡∏ô.' -

#
var text_data1 = 'üì£ ‡πÅ‡∏à‡πâ‡∏á‡∏û‡∏¥‡∏Å‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡πá‡∏Ñ‡∏≠‡∏¥‡∏ô\n' ;
text_data1 += '‚è∞‡∏ß‡∏±‡∏ô-‡πÄ‡∏ß‡∏•‡∏≤\n' + ' \ nüë®‚Äçüíº ‡∏ä‡∏∑‡πà‡∏≠- ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•\n' + data ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å+ '\nüìå Location\n' + ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•. ‡∏•‡∏∞‡∏ï‡∏¥‡∏à‡∏π‡∏î+ "," + ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•. lon + '\n ‡∏´‡∏≠‡∏û‡∏±‡∏Å\n' + geoAddress
#
‡∏•‡∏∞‡∏ï‡∏¥‡∏à‡∏π‡∏î var = ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‚Äã‡∏•‡∏∞‡∏ï‡∏¥‡∏à‡∏π‡∏î
‡∏•‡∏≠‡∏á‡∏à‡∏¥‡∏à‡∏π‡∏î var = ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‚Äã‡πÇ‡∏´‡∏•‡∏ô
var map = ‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‚Äã‡πÉ‡∏´‡∏°‡πà StaticMap ( )
#
setSize ( 600 , 600 ) //(‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î:1300 X 1300
-  ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏†‡∏≤‡∏©‡∏≤( 'TH' )
-  setMobile ( ‡∏à‡∏£‡∏¥‡∏á)
-  setMapType ( ‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà. ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏óStaticMap . HYBRID )
#
‡πÄ‡∏°‡∏û. addMarker ( ‡∏•‡∏∞‡∏ï‡∏¥‡∏à‡∏π‡∏î, ‡∏•‡∏≠‡∏á‡∏à‡∏¥‡∏à‡∏π‡∏î)
var mapBlob = ‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‚Äã‡∏£‡∏±‡∏ö‡∏´‡∏¢‡∏î( )
var mapUrl = ‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‚Äã‡∏£‡∏±‡∏ö MapUrl ( )
‡∏™‡πà‡∏áHttpPostImage ( text_data1 , mapBlob )

#
‡∏ß‡∏±‡∏ô sendHttpPostImage ( mapUrl , mapBlob ) {
‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô var = "xxx" ;
var formData = {
'‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°' : '\n' + mapUrl ,
'imageFile' : mapBlob
‡∏°‡∏µ var =
"‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£" : "‡πÇ‡∏û‡∏™‡∏ï‡πå" ,
"‡πÄ‡∏û‡∏¢‡πå‡πÇ‡∏´‡∏•‡∏î" : formData , // ‡∏ß‡∏±‡∏í‡∏ô‡∏ò‡∏£‡∏£‡∏°, ‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á‡∏†‡∏≤‡∏û, formData, ‡∏ú‡∏π‡πâ‡∏ñ‡∏∑‡∏≠
"‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ä‡∏∑‡πà‡∏≠" : { "‡∏Å‡∏≤‡∏£‡∏¢‡∏∂‡∏î" : " ‡πÄ‡∏õ‡πá‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏©" + ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ä‡∏∑‡πà‡∏≠}
} ;


UrlFetchApp ‚Äã‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•( "https://notify-api.line.me/api/notify" , ‡∏£‡∏±‡∏ö‡∏ä‡∏°) ;
